# Comparing `tmp/o7cli-0.1.85-py3-none-any.whl.zip` & `tmp/o7cli-0.1.95-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,52 +1,52 @@
-Zip file size: 79796 bytes, number of entries: 50
--rw-r--r--  2.0 unx       83 b- defN 21-Oct-11 13:49 o7lib/__init__.py
--rw-r--r--  2.0 unx     1087 b- defN 21-Oct-11 13:49 o7lib/__main__.py
--rw-r--r--  2.0 unx     5626 b- defN 21-Oct-11 13:49 o7lib/menu.py
--rw-r--r--  2.0 unx       87 b- defN 21-Oct-11 13:50 o7lib/version.py
--rw-r--r--  2.0 unx       80 b- defN 21-Oct-11 13:49 o7lib/auth/__init__.py
--rw-r--r--  2.0 unx     6817 b- defN 21-Oct-11 13:49 o7lib/auth/openid.py
--rw-r--r--  2.0 unx       79 b- defN 21-Oct-11 13:49 o7lib/aws/__init__.py
--rw-r--r--  2.0 unx     4806 b- defN 21-Oct-11 13:49 o7lib/aws/asg.py
--rw-r--r--  2.0 unx     2453 b- defN 21-Oct-11 13:49 o7lib/aws/base.py
--rw-r--r--  2.0 unx    20931 b- defN 21-Oct-11 13:49 o7lib/aws/cloudformation.py
--rw-r--r--  2.0 unx     9252 b- defN 21-Oct-11 13:49 o7lib/aws/cloudmap.py
--rw-r--r--  2.0 unx     3315 b- defN 21-Oct-11 13:49 o7lib/aws/cloudtrail.py
--rw-r--r--  2.0 unx     5249 b- defN 21-Oct-11 13:49 o7lib/aws/cloudwatch.py
--rw-r--r--  2.0 unx    16408 b- defN 21-Oct-11 13:49 o7lib/aws/codebuild.py
--rw-r--r--  2.0 unx    10543 b- defN 21-Oct-11 13:49 o7lib/aws/costexplorer.py
--rw-r--r--  2.0 unx     5348 b- defN 21-Oct-11 13:49 o7lib/aws/ec2.py
--rw-r--r--  2.0 unx     5680 b- defN 21-Oct-11 13:49 o7lib/aws/eventbridge.py
--rw-r--r--  2.0 unx    10793 b- defN 21-Oct-11 13:49 o7lib/aws/events.py
--rw-r--r--  2.0 unx     4545 b- defN 21-Oct-11 13:49 o7lib/aws/guardduty.py
--rw-r--r--  2.0 unx     6648 b- defN 21-Oct-11 13:49 o7lib/aws/iam-access-key-mng.py
--rw-r--r--  2.0 unx     4566 b- defN 21-Oct-11 13:49 o7lib/aws/lambdafct.py
--rw-r--r--  2.0 unx     7765 b- defN 21-Oct-11 13:49 o7lib/aws/logs.py
--rw-r--r--  2.0 unx     7742 b- defN 21-Oct-11 13:49 o7lib/aws/logstream.py
--rw-r--r--  2.0 unx    20609 b- defN 21-Oct-11 13:49 o7lib/aws/pipeline.py
--rw-r--r--  2.0 unx     6236 b- defN 21-Oct-11 13:49 o7lib/aws/rds.py
--rw-r--r--  2.0 unx     2627 b- defN 21-Oct-11 13:49 o7lib/aws/reports.py
--rw-r--r--  2.0 unx     2837 b- defN 21-Oct-11 13:49 o7lib/aws/sns.py
--rw-r--r--  2.0 unx     2136 b- defN 21-Oct-11 13:49 o7lib/aws/sts.py
--rw-r--r--  2.0 unx       79 b- defN 21-Oct-11 13:49 o7lib/util/__init__.py
--rw-r--r--  2.0 unx     4955 b- defN 21-Oct-11 13:49 o7lib/util/color.py
--rw-r--r--  2.0 unx     1892 b- defN 21-Oct-11 13:49 o7lib/util/conversion.py
--rw-r--r--  2.0 unx    12238 b- defN 21-Oct-11 13:49 o7lib/util/displays.py
--rw-r--r--  2.0 unx     2638 b- defN 21-Oct-11 13:49 o7lib/util/input.py
--rw-r--r--  2.0 unx      698 b- defN 21-Oct-11 13:49 o7lib/util/progressbar.py
--rw-r--r--  2.0 unx    10617 b- defN 21-Oct-11 13:49 o7lib/util/report.py
--rw-r--r--  2.0 unx     2395 b- defN 21-Oct-11 13:49 o7lib/util/run.py
--rw-r--r--  2.0 unx       80 b- defN 21-Oct-11 13:49 o7lib/weather/__init__.py
--rw-r--r--  2.0 unx      873 b- defN 21-Oct-11 13:49 o7lib/weather/__main__.py
--rw-r--r--  2.0 unx     2399 b- defN 21-Oct-11 13:49 o7lib/weather/ca_mf.py
--rw-r--r--  2.0 unx     6809 b- defN 21-Oct-11 13:49 o7lib/weather/ca_wls.py
--rw-r--r--  2.0 unx     3844 b- defN 21-Oct-11 13:49 o7lib/weather/noaa.py
--rw-r--r--  2.0 unx     4442 b- defN 21-Oct-11 13:49 o7lib/weather/openweather.py
--rw-r--r--  2.0 unx     6911 b- defN 21-Oct-11 13:49 o7lib/weather/planetos.py
--rw-r--r--  2.0 unx    14315 b- defN 21-Oct-11 13:49 o7lib/weather/wind_report.py
--rw-r--r--  2.0 unx      575 b- defN 21-Oct-11 13:50 o7cli-0.1.85.dist-info/LICENSE
--rw-r--r--  2.0 unx     1511 b- defN 21-Oct-11 13:50 o7cli-0.1.85.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 21-Oct-11 13:50 o7cli-0.1.85.dist-info/WHEEL
--rw-r--r--  2.0 unx       40 b- defN 21-Oct-11 13:50 o7cli-0.1.85.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        6 b- defN 21-Oct-11 13:50 o7cli-0.1.85.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3902 b- defN 21-Oct-11 13:50 o7cli-0.1.85.dist-info/RECORD
-50 files, 255659 bytes uncompressed, 73734 bytes compressed:  71.2%
+Zip file size: 77532 bytes, number of entries: 50
+-rw-r--r--  2.0 unx       83 b- defN 21-Oct-14 19:24 o7lib/__init__.py
+-rw-r--r--  2.0 unx     1087 b- defN 21-Oct-14 19:24 o7lib/__main__.py
+-rw-r--r--  2.0 unx     5626 b- defN 21-Oct-14 19:24 o7lib/menu.py
+-rw-r--r--  2.0 unx       87 b- defN 21-Oct-14 19:24 o7lib/version.py
+-rw-r--r--  2.0 unx       80 b- defN 21-Oct-14 19:24 o7lib/auth/__init__.py
+-rw-r--r--  2.0 unx     6817 b- defN 21-Oct-14 19:24 o7lib/auth/openid.py
+-rw-r--r--  2.0 unx       79 b- defN 21-Oct-14 19:24 o7lib/aws/__init__.py
+-rw-r--r--  2.0 unx     4806 b- defN 21-Oct-14 19:24 o7lib/aws/asg.py
+-rw-r--r--  2.0 unx     2453 b- defN 21-Oct-14 19:24 o7lib/aws/base.py
+-rw-r--r--  2.0 unx    20501 b- defN 21-Oct-14 19:24 o7lib/aws/cloudformation.py
+-rw-r--r--  2.0 unx     9252 b- defN 21-Oct-14 19:24 o7lib/aws/cloudmap.py
+-rw-r--r--  2.0 unx     3315 b- defN 21-Oct-14 19:24 o7lib/aws/cloudtrail.py
+-rw-r--r--  2.0 unx     5249 b- defN 21-Oct-14 19:24 o7lib/aws/cloudwatch.py
+-rw-r--r--  2.0 unx    16241 b- defN 21-Oct-14 19:24 o7lib/aws/codebuild.py
+-rw-r--r--  2.0 unx    10543 b- defN 21-Oct-14 19:24 o7lib/aws/costexplorer.py
+-rw-r--r--  2.0 unx     5302 b- defN 21-Oct-14 19:24 o7lib/aws/ec2.py
+-rw-r--r--  2.0 unx     5680 b- defN 21-Oct-14 19:24 o7lib/aws/eventbridge.py
+-rw-r--r--  2.0 unx     3549 b- defN 21-Oct-14 19:24 o7lib/aws/events.py
+-rw-r--r--  2.0 unx     4545 b- defN 21-Oct-14 19:24 o7lib/aws/guardduty.py
+-rw-r--r--  2.0 unx     6648 b- defN 21-Oct-14 19:24 o7lib/aws/iam-access-key-mng.py
+-rw-r--r--  2.0 unx     4521 b- defN 21-Oct-14 19:24 o7lib/aws/lambdafct.py
+-rw-r--r--  2.0 unx     7765 b- defN 21-Oct-14 19:24 o7lib/aws/logs.py
+-rw-r--r--  2.0 unx     7248 b- defN 21-Oct-14 19:24 o7lib/aws/logstream.py
+-rw-r--r--  2.0 unx    25883 b- defN 21-Oct-14 19:24 o7lib/aws/pipeline.py
+-rw-r--r--  2.0 unx     6141 b- defN 21-Oct-14 19:24 o7lib/aws/rds.py
+-rw-r--r--  2.0 unx     2627 b- defN 21-Oct-14 19:24 o7lib/aws/reports.py
+-rw-r--r--  2.0 unx     2737 b- defN 21-Oct-14 19:24 o7lib/aws/sns.py
+-rw-r--r--  2.0 unx     2136 b- defN 21-Oct-14 19:24 o7lib/aws/sts.py
+-rw-r--r--  2.0 unx       79 b- defN 21-Oct-14 19:24 o7lib/util/__init__.py
+-rw-r--r--  2.0 unx     4955 b- defN 21-Oct-14 19:24 o7lib/util/color.py
+-rw-r--r--  2.0 unx     2167 b- defN 21-Oct-14 19:24 o7lib/util/conversion.py
+-rw-r--r--  2.0 unx    13434 b- defN 21-Oct-14 19:24 o7lib/util/displays.py
+-rw-r--r--  2.0 unx     2638 b- defN 21-Oct-14 19:24 o7lib/util/input.py
+-rw-r--r--  2.0 unx      698 b- defN 21-Oct-14 19:24 o7lib/util/progressbar.py
+-rw-r--r--  2.0 unx    10617 b- defN 21-Oct-14 19:24 o7lib/util/report.py
+-rw-r--r--  2.0 unx     2395 b- defN 21-Oct-14 19:24 o7lib/util/run.py
+-rw-r--r--  2.0 unx       80 b- defN 21-Oct-14 19:24 o7lib/weather/__init__.py
+-rw-r--r--  2.0 unx      873 b- defN 21-Oct-14 19:24 o7lib/weather/__main__.py
+-rw-r--r--  2.0 unx     2399 b- defN 21-Oct-14 19:24 o7lib/weather/ca_mf.py
+-rw-r--r--  2.0 unx     6809 b- defN 21-Oct-14 19:24 o7lib/weather/ca_wls.py
+-rw-r--r--  2.0 unx     3844 b- defN 21-Oct-14 19:24 o7lib/weather/noaa.py
+-rw-r--r--  2.0 unx     4442 b- defN 21-Oct-14 19:24 o7lib/weather/openweather.py
+-rw-r--r--  2.0 unx     6911 b- defN 21-Oct-14 19:24 o7lib/weather/planetos.py
+-rw-r--r--  2.0 unx    14315 b- defN 21-Oct-14 19:24 o7lib/weather/wind_report.py
+-rw-r--r--  2.0 unx      575 b- defN 21-Oct-14 19:24 o7cli-0.1.95.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1511 b- defN 21-Oct-14 19:24 o7cli-0.1.95.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 21-Oct-14 19:24 o7cli-0.1.95.dist-info/WHEEL
+-rw-r--r--  2.0 unx       40 b- defN 21-Oct-14 19:24 o7cli-0.1.95.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        6 b- defN 21-Oct-14 19:24 o7cli-0.1.95.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3901 b- defN 21-Oct-14 19:24 o7cli-0.1.95.dist-info/RECORD
+50 files, 253782 bytes uncompressed, 71470 bytes compressed:  71.8%
```

## zipnote {}

```diff
@@ -126,26 +126,26 @@
 
 Filename: o7lib/weather/planetos.py
 Comment: 
 
 Filename: o7lib/weather/wind_report.py
 Comment: 
 
-Filename: o7cli-0.1.85.dist-info/LICENSE
+Filename: o7cli-0.1.95.dist-info/LICENSE
 Comment: 
 
-Filename: o7cli-0.1.85.dist-info/METADATA
+Filename: o7cli-0.1.95.dist-info/METADATA
 Comment: 
 
-Filename: o7cli-0.1.85.dist-info/WHEEL
+Filename: o7cli-0.1.95.dist-info/WHEEL
 Comment: 
 
-Filename: o7cli-0.1.85.dist-info/entry_points.txt
+Filename: o7cli-0.1.95.dist-info/entry_points.txt
 Comment: 
 
-Filename: o7cli-0.1.85.dist-info/top_level.txt
+Filename: o7cli-0.1.95.dist-info/top_level.txt
 Comment: 
 
-Filename: o7cli-0.1.85.dist-info/RECORD
+Filename: o7cli-0.1.95.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## o7lib/version.py

```diff
@@ -1,2 +1,2 @@
 """Module Version, value is replaced during the build process"""
-VERSION_ID = '0.1.85'
+VERSION_ID = '0.1.95'
```

## o7lib/aws/cloudformation.py

```diff
@@ -71,21 +71,14 @@
                 param['NextPageToken'] = resp['NextPageToken']
             else:
                 done = True
 
             logger.info(f'LoadStacks: Number of Stacks found {len(resp["Stacks"])}')
             for stack in resp['Stacks'] :
 
-                lastUpdate = stack.get('LastUpdatedTime', None)
-                stack['LastUpdatedDelta'] = 'Never'
-                if lastUpdate is not None:
-                    sinceUpdate = datetime.datetime.now(datetime.timezone.utc) - lastUpdate
-                    sinceStr = f'{sinceUpdate}'
-                    stack['LastUpdatedDelta'] = sinceStr.split(',')[0].split('.')[0]
-
                 driftStatus = stack['DriftInformation'].get('StackDriftStatus', '')
                 driftDate = stack['DriftInformation'].get('LastCheckTimestamp', None)
                 if driftDate is not None:
                     driftStatus = f'{driftStatus} ({driftDate:%Y-%m-%d})'
 
                 stack['DriftStatus'] = driftStatus
 
@@ -256,15 +249,15 @@
         print('')
 
         params = {
             'columns' : [
                 {'title' : 'id'      , 'type': 'i',       'minWidth' : 4  },
                 {'title' : 'Name'    , 'type': 'str',  'dataName': 'StackName'},
                 {'title' : 'Creation', 'type': 'date', 'dataName': 'CreationTime'},
-                {'title' : 'Updated' , 'type': 'str',  'dataName': 'LastUpdatedDelta'},
+                {'title' : 'Updated' , 'type': 'since',  'dataName': 'LastUpdatedTime'},
                 {'title' : 'Status'  , 'type': 'str',  'dataName': 'StackStatus', 'format' : 'aws-status'},
                 {'title' : 'Reason'  , 'type': 'str',  'dataName': 'StackStatusReason', 'maxWidth' : 50},
                 {'title' : 'Drift'     , 'type': 'str',     'width' : 20, 'dataName': 'DriftStatus', 'format' : 'aws-drift'},
             ]
         }
         o7lib.util.displays.Table(params, stacks)
 
@@ -397,15 +390,15 @@
         """Display details for a specific Stack"""
 
         self.ConsoleTitle(left=f'Cloudformation Details for Stack: {stack.get("StackName", "")}')
         print('')
 
         print(f'Description: {stack.get("Description", "")}')
         print(f'Creation: {stack.get("CreationTime", ""):%Y-%m-%d}')
-        print(f'Last Updated: {stack.get("LastUpdatedDelta", "")}')
+        print(f'Last Updated: {stack.get("LastUpdatedTime", "NA")}')
         print(f'Status: {o7lib.util.displays.FormatAWSStatus(stack.get("StackStatus", ""))}')
         print(f'Status Reason: {stack.get("StackStatusReason", "-")}')
 
         print(f'Drift Detection: {o7lib.util.displays.FormatAWSDrift(stack.get("DriftStatus", "-"))}')
 
         print(f'Capabilities: {stack.get("Capabilities", [])}')
         print(f'Tags: {stack.get("Tags", [])}')
@@ -554,9 +547,8 @@
 if __name__ == "__main__":
 
     logging.basicConfig(
         level=logging.INFO,
         format="[%(levelname)-5.5s] [%(name)s] %(message)s"
     )
 
-    Cloudformation().MenuStacks()
-    #MenuSignleStack('Access-Key-Management')
+    Cloudformation().MenuStacks()
```

## o7lib/aws/codebuild.py

```diff
@@ -443,11 +443,8 @@
 if __name__ == "__main__":
 
     logging.basicConfig(
         level=logging.INFO,
         format="[%(levelname)-5.5s] [%(name)s] %(message)s"
     )
 
-    CodeBuild().MenuProjects()
-    # execSum = Pipeline(region='us-east-1').LoadExecutions('client-rbc-recon', maxExec=1)
-    # pprint.pprint(execSum)
-    #MenuSignleStack('Access-Key-Management')
+    CodeBuild().MenuProjects()
```

## o7lib/aws/ec2.py

```diff
@@ -158,8 +158,7 @@
 
     logging.basicConfig(
         level=logging.INFO,
         format="[%(levelname)-5.5s] [%(name)s] %(message)s"
     )
 
     Ec2().MenuInstances()
-    #MenuSignleStack('Access-Key-Management')
```

## o7lib/aws/events.py

```diff
@@ -42,38 +42,38 @@
     if snsMessage['source'] == "aws.guardduty":
 
         theType = snsMessage["detail-type"]
 
         if theType == 'GuardDuty Finding' :
             theMsg = theType + '\n'
             theMsg += snsMessage['detail']['description']
-        
+
         elif theType == 'AWS API Call via CloudTrail' :
             theMsg = 'GuardDuty API' + '\n'
             theMsg += snsMessage['detail']['eventName'] + '\n'
             theMsg += 'By ' + snsMessage['detail']['userIdentity']['userName']
         else:
             theMsg = theType + '\n'
             theMsg = 'New Guarduty Type'
-    
+
     return theMsg
 
 #*************************************************
-# Function that can transmit a Event to another region that can send SMS.  
+# Function that can transmit a Event to another region that can send SMS.
 #*************************************************
 def TransmitToSmsTopic (snsEvent, arnSmsTopic):
 
     #print(f'TransmitToSms snsEvent: {snsEvent}')
     rawSnsMessage = snsEvent["Message"]
     jsonSnsMessage = json.loads(rawSnsMessage)
 
-    #print(f'Complete Sns Message:')       
+    #print(f'Complete Sns Message:')
     #pprint.pprint(jsonSnsMessage)
 
-    theMsg = ReformatForSMS(jsonSnsMessage)        
+    theMsg = ReformatForSMS(jsonSnsMessage)
     print(f'Reformat Sms Message: {theMsg}')
 
     sns = boto3.client(service_name='sns', region_name='us-east-1')
 
     params = {
         'Message': theMsg,
         'Subject': snsEvent['Subject'],
@@ -95,24 +95,12 @@
         print(f'[ERROR] Environement Variable ARN_SMS_TOPIC is missing')
         return {'statusCode': 401,'body': json.dumps('Environement Variable ARN_SMS_TOPIC is missing')}
 
 
     #print(f'Handler Event {event}')
     theSns = event['Records'][0]['Sns']
     TransmitToSmsTopic(theSns, arnSmsTopic = arnSmsTopic)
-    
+
     return {
         'statusCode': 200,
         'body': json.dumps('Done')
     }
-
-
-#*************************************************
-#
-#*************************************************
-if __name__ == "__main__":
- 
-
-    GuardDutyEvent1 =  {'Records': [{'EventSource': 'aws:sns', 'EventVersion': '1.0', 'EventSubscriptionArn': 'arn:aws:sns:ca-central-1:303697492861:phil-pager:e4a6578e-8b89-4220-9936-686197ba386f', 'Sns': {'Type': 'Notification', 'MessageId': '85e6d543-6da0-57f3-9388-8dfd4d63dc7d', 'TopicArn': 'arn:aws:sns:ca-central-1:303697492861:phil-pager', 'Subject': None, 'Message': '{"version":"0","id":"9f0a1529-b909-c3dc-e0c0-3cc988be73a6","detail-type":"AWS API Call via CloudTrail","source":"aws.guardduty","account":"303697492861","time":"2021-03-07T00:29:35Z","region":"ca-central-1","resources":[],"detail":{"eventVersion":"1.08","userIdentity":{"type":"IAMUser","principalId":"AIDAIN6CTTAXW7PC3RIGS","arn":"arn:aws:iam::303697492861:user/phil","accountId":"303697492861","accessKeyId":"AKIAUNNOH7N6ZJM7336Y","userName":"phil"},"eventTime":"2021-03-07T00:29:35Z","eventSource":"guardduty.amazonaws.com","eventName":"CreateSampleFindings","sourceIPAddress":"162.244.45.96","userAgent":"aws-cli/2.1.24 Python/3.7.3 Linux/4.19.121-linuxkit exe/x86_64.debian.10 prompt/off command/guardduty.create-sample-findings","requestParameters":{"findingTypes":["Backdoor:EC2/Spambot"],"detectorId":"e8b2d11eace51dd009880267917bb379"},"responseElements":null,"requestID":"fecc958f-1236-41fd-97a8-ca0d04c86fe4","eventID":"f4842151-d501-4c15-94bd-ddcec3f3acc5","readOnly":false,"eventType":"AwsApiCall","managementEvent":true,"eventCategory":"Management"}}', 'Timestamp': '2021-03-07T00:29:55.065Z', 'SignatureVersion': '1', 'Signature': 'r79rBp8VcEloebZoDjwdIqbgImuZ5Q2mqdu1EZJFX9xbGBPW6iCsdVbd1F1YqBYb5rqFjiizzWKxJ05P/CGpxt6mXadEczAmDxL0/whBqNPdSLdSLrOisWkeBiijuIkSLsLFZibZqsfTPY2yV614qBhSiodXGmP6SeFF6xbdYNn+Fs7cDBoikK/EALuwCPofOCU+acsEIJBXoqVyVYB6IXjUEcmo7JsCtaAsBr4maPKcv3q6QltpdWdj5JtbGJyIBksxOmJ2vXVKNMzA7cUhwts0llPB3p9AZ9qSLrZGm7HGcBy9AMShkzXtrcsQPz4XBgAor5Mu44I1djAL79QF4Q==', 'SigningCertUrl': 'https://sns.ca-central-1.amazonaws.com/SimpleNotificationService-010a507c1833636cd94bdb98bd93083a.pem', 'UnsubscribeUrl': 'https://sns.ca-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:ca-central-1:303697492861:phil-pager:e4a6578e-8b89-4220-9936-686197ba386f', 'MessageAttributes': {}}}]}
-    # GuardDutyEvent2 = {'Records': [{'EventSource': 'aws:sns', 'EventVersion': '1.0', 'EventSubscriptionArn': 'arn:aws:sns:ca-central-1:303697492861:phil-pager:e4a6578e-8b89-4220-9936-686197ba386f', 'Sns': {'Type': 'Notification', 'MessageId': 'f041e509-0fa7-5c39-af20-bdb72e802e09', 'TopicArn': 'arn:aws:sns:ca-central-1:303697492861:phil-pager', 'Subject': None, 'Message': '{"version":"0","id":"860d8fdd-3d43-d844-370b-0fb08d1b661d","detail-type":"GuardDuty Finding","source":"aws.guardduty","account":"303697492861","time":"2021-03-07T00:30:34Z","region":"ca-central-1","resources":[],"detail":{"schemaVersion":"2.0","accountId":"303697492861","region":"ca-central-1","partition":"aws","id":"7ebc050b71c556086b524045c9067feb","arn":"arn:aws:guardduty:ca-central-1:303697492861:detector/e8b2d11eace51dd009880267917bb379/finding/7ebc050b71c556086b524045c9067feb","type":"Backdoor:EC2/Spambot","resource":{"resourceType":"Instance","instanceDetails":{"instanceId":"i-99999999","instanceType":"m3.xlarge","outpostArn":"arn:aws:outposts:us-west-2:123456789000:outpost/op-0fbc006e9abbc73c3","launchTime":"2016-08-02T02:05:06Z","platform":null,"productCodes":[{"productCodeId":"GeneratedFindingProductCodeId","productCodeType":"GeneratedFindingProductCodeType"}],"iamInstanceProfile":{"arn":"arn:aws:iam::303697492861:example/instance/profile","id":"GeneratedFindingInstanceProfileId"},"networkInterfaces":[{"ipv6Addresses":[],"networkInterfaceId":"eni-bfcffe88","privateDnsName":"GeneratedFindingPrivateDnsName","privateIpAddress":"10.0.0.1","privateIpAddresses":[{"privateDnsName":"GeneratedFindingPrivateName","privateIpAddress":"10.0.0.1"}],"subnetId":"GeneratedFindingSubnetId","vpcId":"GeneratedFindingVPCId","securityGroups":[{"groupName":"GeneratedFindingSecurityGroupName","groupId":"GeneratedFindingSecurityId"}],"publicDnsName":"GeneratedFindingPublicDNSName","publicIp":"198.51.100.0"}],"tags":[{"key":"GeneratedFindingInstaceTag1","value":"GeneratedFindingInstaceValue1"},{"key":"GeneratedFindingInstaceTag2","value":"GeneratedFindingInstaceTagValue2"},{"key":"GeneratedFindingInstaceTag3","value":"GeneratedFindingInstaceTagValue3"},{"key":"GeneratedFindingInstaceTag4","value":"GeneratedFindingInstaceTagValue4"},{"key":"GeneratedFindingInstaceTag5","value":"GeneratedFindingInstaceTagValue5"},{"key":"GeneratedFindingInstaceTag6","value":"GeneratedFindingInstaceTagValue6"},{"key":"GeneratedFindingInstaceTag7","value":"GeneratedFindingInstaceTagValue7"},{"key":"GeneratedFindingInstaceTag8","value":"GeneratedFindingInstaceTagValue8"},{"key":"GeneratedFindingInstaceTag9","value":"GeneratedFindingInstaceTagValue9"}],"instanceState":"running","availabilityZone":"GeneratedFindingInstaceAvailabilityZone","imageId":"ami-99999999","imageDescription":"GeneratedFindingInstaceImageDescription"}},"service":{"serviceName":"guardduty","detectorId":"e8b2d11eace51dd009880267917bb379","action":{"actionType":"NETWORK_CONNECTION","networkConnectionAction":{"connectionDirection":"OUTBOUND","localIpDetails":{"ipAddressV4":"10.0.0.23"},"remoteIpDetails":{"ipAddressV4":"198.51.100.0","organization":{"asn":"-1","asnOrg":"GeneratedFindingASNOrg","isp":"GeneratedFindingISP","org":"GeneratedFindingORG"},"country":{"countryName":"GeneratedFindingCountryName"},"city":{"cityName":"GeneratedFindingCityName"},"geoLocation":{"lat":0,"lon":0}},"remotePortDetails":{"port":25,"portName":"SMTP"},"localPortDetails":{"port":2000,"portName":"Unknown"},"protocol":"TCP","blocked":false}},"resourceRole":"TARGET","additionalInfo":{"unusualProtocol":"UDP","threatListName":"GeneratedFindingThreatListName","unusual":25,"sample":true},"eventFirstSeen":"2021-03-07T00:29:35.498Z","eventLastSeen":"2021-03-07T00:29:35.498Z","archived":false,"count":1},"severity":5,"createdAt":"2021-03-07T00:29:35.498Z","updatedAt":"2021-03-07T00:29:35.498Z","title":"Unusual outbound communication on port 25 from EC2 instance i-99999999.","description":"EC2 instance i-99999999 is communicating on an unusual port 25 with a remote host. This port is commonly used to send email."}}', 'Timestamp': '2021-03-07T00:31:35.840Z', 'SignatureVersion': '1', 'Signature': 'UPoPMP0kXdy27TNpuCYluNvOfIm+sbW4c9pv7XRXUuU/TIoHWQUUQiNSSD/C3rWSd/xhfx0H/x/dXXTKRMIEnJAgxnK8UE653atC92XbQqU4PcJrwxPKpzF4t6hicRrMDQdlBpjkJcHXLjGvJUcnB44Pui1R/tfY+Wp9J2jBwKnK8HiukWBhaiaHtEJP55OJnQn9FXtdAbC0jwl/v0ayHWes3wBomqtO38mHKjuYdIZlCCiyCg2kCOGYvXacO6JFWrVSNgZu1UuFFpo9UxI3jne/z5efLsGnh5lgySuuHTNmp1ZACVxX5MaDpZY0nm7uxkfp+qqavdEODpP8+REl2w==', 'SigningCertUrl': 'https://sns.ca-central-1.amazonaws.com/SimpleNotificationService-010a507c1833636cd94bdb98bd93083a.pem', 'UnsubscribeUrl': 'https://sns.ca-central-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:ca-central-1:303697492861:phil-pager:e4a6578e-8b89-4220-9936-686197ba386f', 'MessageAttributes': {}}}]}
-
-    # TransmitToSms_handler(GuardDutyEvent2, None)
```

## o7lib/aws/lambdafct.py

```diff
@@ -129,8 +129,8 @@
 
     logging.basicConfig(
         level=logging.INFO,
         format="[%(levelname)-5.5s] [%(name)s] %(message)s"
     )
 
     Lambda().MenuFunctions()
-    #MenuSignleStack('Access-Key-Management')
+
```

## o7lib/aws/logstream.py

```diff
@@ -213,20 +213,7 @@
 if __name__ == "__main__":
 
     logging.basicConfig(
         level=logging.INFO,
         format="[%(levelname)-5.5s] [%(name)s] %(message)s"
     )
 
-    GROUP_NAME = '/aws/codebuild/dragon-test-qa-1'
-    STREAM_NAME = 'af1bbcf0-add8-41c4-91fb-42430ae29d7e'
-
-    cwl = Logstream(GROUP_NAME, STREAM_NAME)
-    cwl.fromHead = False
-    cwl.maxPerLoad = 10
-    #cwl.displayTimestamp = True
-    #cwl.displayLineNumber = True
-    cwl.Menu()
-    # execSum = Pipeline(region='us-east-1').LoadExecutions('client-rbc-recon', maxExec=1)
-    # theText = cwl.ConvertEventsToText(theEvents)
-    # print(theText)
-    #MenuSignleStack('Access-Key-Management')
```

## o7lib/aws/pipeline.py

```diff
@@ -98,15 +98,14 @@
 
         # https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/codepipeline.html#CodePipeline.Client.get_pipeline
         respPl= self.ppClient.get_pipeline(**param)
 
         respState = self.ppClient.get_pipeline_state(**param)
         #pprint.pprint(respState)
 
-
         if 'pipeline' not in respPl:
             return None
 
         if 'stageStates' not in respState:
             return respPl['pipeline']
 
         actionId = 1
@@ -150,14 +149,58 @@
 
         #pprint.pprint(respPl)
         return respPl['pipeline']
 
     #*************************************************
     #
     #*************************************************
+    def LoadExecutionDetails(self, plName, execId):
+        """Returns Details for a Pipeline Execution"""
+
+        logger.info(f'LoadExecutionDetails {plName=} {execId=}')
+
+        param={
+            'pipelineName' : plName,
+            'filter': {'pipelineExecutionId': execId}
+        }
+
+        # https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/codepipeline.html#CodePipeline.Client.get_pipeline_execution
+        respExec= self.ppClient.get_pipeline_execution(pipelineName=plName, pipelineExecutionId=execId)
+        #pprint.pprint(respExec)
+
+        if 'pipelineExecution' not in respExec:
+            return None
+
+        details = respExec['pipelineExecution']
+        details['actions'] = []
+
+        # https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/codepipeline.html#CodePipeline.Client.list_action_executions
+        respActions= self.ppClient.list_action_executions(**param)
+        #pprint.pprint(respActions)
+
+
+        if 'actionExecutionDetails' not in respActions:
+            return details
+
+        actionId = 1
+
+        # # Merge Actions with summary
+        for action in reversed(respActions['actionExecutionDetails']):
+
+            logger.info(f'{actionId}. {action["stageName"]=} {action["actionName"]=}')
+
+            action['id'] = actionId
+            actionId += 1
+            details['actions'].append(action)
+
+        return details
+
+    #*************************************************
+    #
+    #*************************************************
     def LoadExecutions(self, plName, maxExec = None):
         """Returns Execution Summaries for a Pipeline"""
 
         logger.info(f'LoadExecutions for {plName}')
 
         ret = []
         param={'pipelineName' : plName}
@@ -295,16 +338,16 @@
         params = {
             # 'title' : f"Pipelines List - {self.TitleLine()}",
             'columns' : [
                 {'title' : 'id'      , 'type': 'i',       'minWidth' : 4  },
                 {'title' : 'Name'    , 'type': 'str',  'dataName': 'name'},
                 {'title' : 'Version' , 'type': 'str', 'dataName': 'version'},
                 {'title' : 'Creation', 'type': 'date', 'dataName': 'created'},
-                {'title' : 'Updated' , 'type': 'date',  'dataName': 'updated'},
-                {'title' : 'Started' , 'type': 'datetime',  'dataName': 'execStart'},
+                {'title' : 'Updated' , 'type': 'since',  'dataName': 'updated'},
+                {'title' : 'Last Execution' , 'type': 'since',  'dataName': 'execStart'},
                 {'title' : 'Status' ,  'type': 'str',  'dataName': 'execStatus', 'format' : 'aws-status'},
             ]
         }
         o7lib.util.displays.Table(params, pipelines)
 
 
     #*************************************************
@@ -325,15 +368,15 @@
         stages = plDetails.get("stages",[])
         stageParams = {
             'columns' : [
                 {'dataName': 'id'        , 'title' : 'id'    , 'type': 'int',   'fixWidth' : 4  },
                 {'dataName': 'name'      , 'title' : 'Name'  , 'type': 'str', 'fixWidth' : 40  },
                 {'dataName': 'runOrder'  , 'title' : 'Order' , 'type': 'int', 'fixWidth' : 3  },
                 {'dataName': 'status'    , 'title' : 'Status' , 'type': 'str', 'fixWidth' : 10, 'format': 'aws-status' },
-                {'dataName': 'statusDate', 'title' : 'Updated' , 'type': 'datetime', 'fixWidth' : 20, 'format': 'aws-status' },
+                {'dataName': 'statusDate', 'title' : 'Updated' , 'type': 'since', 'fixWidth' : 10, 'format': 'aws-status' },
                 {'dataName': 'statusMsg' , 'title' : 'Message' , 'type': 'str', 'format': 'aws-status' },
             ]
         }
 
         for stage in stages:
 
             # Check if Inbound Allowed
@@ -368,20 +411,82 @@
 
         params = {
             'columns' : [
                 {'title' : 'id'      , 'type': 'i',       'minWidth' : 4  },
                 {'title' : 'Execution Id', 'type': 'str',  'dataName': 'pipelineExecutionId'},
                 {'title' : 'Status'      , 'type': 'str',  'dataName': 'status', 'format' : 'aws-status'},
                 {'title' : 'Started'     , 'type': 'datetime',  'dataName': 'startTime'},
-                {'title' : 'Updated'     , 'type': 'datetime',  'dataName': 'lastUpdateTime'},
+                {'title' : 'Updated'     , 'type': 'since',  'dataName': 'lastUpdateTime'},
                 {'title' : 'Summary'     , 'type': 'str',  'dataName': 'sourceSummary'}
             ]
         }
         o7lib.util.displays.Table(params, executions)
 
+    #*************************************************
+    #
+    #*************************************************
+    def DisplayExecutionDetails(self, execDetails):
+        """Displays a Details of a pipeline execution"""
+
+        self.ConsoleTitle(left = f'Execution Details for Pipeline : {execDetails.get("pipelineName", "-")}')
+
+        print(f'ExecId : {execDetails.get("pipelineExecutionId", "-")}')
+
+        status = o7lib.util.displays.FormatAWSStatus(execDetails.get('status', '-'))
+        print(f'Status: {status} ({execDetails.get("statusSummary", "-")})')
+        print(f'Version: {execDetails.get("pipelineVersion", "NA")}')
+
+        print('Artefacts')
+
+        artefactParams = {
+            'columns' : [
+                {'dataName': 'name'                          , 'title' : 'Name'     , 'type': 'str' },
+                {'dataName': 'revisionSummary.ProviderType'  , 'title' : 'Provider' , 'type': 'str' },
+                {'dataName': 'revisionSummary.CommitMessage'  , 'title' : 'Commit Message' , 'type': 'str' }
+            ]
+        }
+        o7lib.util.displays.Table(artefactParams, execDetails.get("artifactRevisions", []))
+
+        print('')
+        print('Actions')
+        actions = execDetails.get("actions",[])
+        actionParams = {
+            'columns' : [
+                {'dataName': 'id'        , 'title' : 'id'    , 'type': 'int',   'fixWidth' : 4  },
+                {'dataName': 'actionName', 'title' : 'Name'  , 'type': 'str' },
+                {'dataName': 'status'    , 'title' : 'Status' , 'type': 'str', 'fixWidth' : 10, 'format': 'aws-status' },
+                {'dataName': 'startTime', 'title' : 'Started' , 'type': 'datetime' },
+                {'dataName': 'lastUpdateTime', 'title' : 'Updated' , 'type': 'since'},
+                {'dataName': 'output.outputVariables', 'title' : 'Output Var.' , 'type': 'str'}
+            ]
+        }
+
+        # for stage in stages:
+
+        #     # Check if Inbound Allowed
+        #     if 'inboundTransitionState' in stage:
+        #         allowed = stage['inboundTransitionState'].get('enabled', True)
+        #         if allowed:
+        #             print(" | ")
+        #         else:
+        #             print(f" X  Disable Reason: {stage['inboundTransitionState'].get('disabledReason', 'NA')}")
+
+        #     status = o7lib.util.displays.FormatAWSStatus(stage.get('status', '-'))
+        #     execId = stage.get('latestExecution',{}).get('pipelineExecutionId', '-')
+
+        #     revSummary = []
+        #     for rev in stage.get('latestExecutionDetails',{}).get('artifactRevisions', []):
+        #         revSummary.append(rev.get('revisionSummary','NA').split('\n')[0].strip())
+        #     revSummary = " / ".join(revSummary)
+
+        #     print(f"Stage: {stage.get('name', '-')}  Execution ID: {execId} ({revSummary})")
+        #     print(f"Status: {status} ")
+
+        o7lib.util.displays.Table(actionParams, actions)
+
 
     #*************************************************
     #
     #*************************************************
     def MenuPipelines(self):
         """Menu to view and edit all pipelines in current region"""
 
@@ -459,37 +564,64 @@
             key = o7lib.util.input.InputString('Option -> Details(d) Back (any) :')
             if key == 'd':
                 o7lib.aws.codebuild.CodeBuild(session = self.session).MenuBuildDetail(externalExecutionId)
 
         else:
             o7lib.util.input.WaitInput()
 
+
+    #*************************************************
+    #
+    #*************************************************
+    def MenuExecutionDetails(self, plName, execId):
+        """Menu to view details of a pipeline execution"""
+
+        while True :
+            execDetails = self.LoadExecutionDetails(plName, execId=execId)
+            self.DisplayExecutionDetails(execDetails)
+
+            keyType, key = o7lib.util.input.InputMulti('Option -> Back(b) Raw(r) : ')
+
+            if keyType == 'str':
+                if key.lower() == 'b':
+                    break
+
+                if key.lower() == 'r':
+                    pprint.pprint(execDetails)
+                    o7lib.util.input.WaitInput()
+
+            if keyType == 'int' and key > 0 and key <= len(execDetails['actions']):
+                pprint.pprint(execDetails['actions'][key - 1])
+                o7lib.util.input.WaitInput()
+
+
     #*************************************************
     #
     #*************************************************
     def MenuExecutions(self, plName):
         """Menu to view execution list of a pipeline"""
 
         while True :
             executions = self.LoadExecutions(plName, maxExec=25)
             self.DisplayExecutions(executions)
 
-            keyType, key = o7lib.util.input.InputMulti('Option -> Back(b) Raw Execution(int) : ')
+            keyType, key = o7lib.util.input.InputMulti('Option -> Back(b) Raw(r) Execution Details(int) : ')
 
             if keyType == 'str':
                 if key.lower() == 'b':
                     break
 
                 if key.lower() == 'r':
                     pprint.pprint(executions)
                     o7lib.util.input.WaitInput()
 
             if keyType == 'int' and key > 0 and key <= len(executions):
-                pprint.pprint(executions[key - 1])
-                o7lib.util.input.WaitInput()
+                #pprint.pprint(executions[key - 1])
+                self.MenuExecutionDetails(plName=plName, execId=executions[key - 1]['pipelineExecutionId'])
+
 
 
 
 
     #*************************************************
     #
     #*************************************************
@@ -519,15 +651,15 @@
 
                 if key.lower() == 'e':
                     self.MenuExecutions(plName)
 
             if keyType == 'int' :
                 for stage in plDetails.get("stages",[]):
                     for action in stage.get('actions',[]):
-                        if action['id'] == str(key):
+                        if action['id'] == key:
                             execId = stage.get('latestExecution',{}).get('pipelineExecutionId', 'na')
                             self.MenuActionDetails(plName=plName, stageName=stage['name'], execId=execId, action=action)
 
 
 
 #*************************************************
 #
@@ -535,11 +667,8 @@
 if __name__ == "__main__":
 
     logging.basicConfig(
         level=logging.INFO,
         format="[%(levelname)-5.5s] [%(name)s] %(message)s"
     )
 
-    Pipeline(region='us-east-1').MenuPipelines()
-    # execSum = Pipeline(region='us-east-1').LoadExecutions('client-rbc-recon', maxExec=1)
-    # pprint.pprint(execSum)
-    #MenuSignleStack('Access-Key-Management')
+    #Pipeline(region='us-east-1').MenuPipelines()
```

## o7lib/aws/rds.py

```diff
@@ -184,9 +184,8 @@
 
     logging.basicConfig(
         level=logging.INFO,
         format="[%(levelname)-5.5s] [%(name)s] %(message)s"
     )
 
     Rds().MenuInstances()
-    #Rds().LoadCpuUtilization('dragon-prod-db-b')
-    #MenuSignleStack('Access-Key-Management')
+
```

## o7lib/aws/sns.py

```diff
@@ -14,35 +14,35 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 #************************************************************************
 
 
 #--------------------------------
-# 
+#
 #--------------------------------
 import boto3
 import logging
 import pandas as pd
 import o7lib.aws.base
 
 logger=logging.getLogger(__name__)
 
 # https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sns.html
 
 #*************************************************
-# 
+#
 #*************************************************
 class Sns(o7lib.aws.base.Base):
 
     #*************************************************
-    # 
+    #
     #*************************************************
     def __init__(self, profile = None, region = None, session = None):
-        super().__init__(profile=profile, region=region, session = session) 
+        super().__init__(profile=profile, region=region, session = session)
         self.sns = self.session.client('sns', region_name=region)
 
 
     #*************************************************
     #
     #*************************************************
     def LoadSubcriptions(self, arn):
@@ -78,11 +78,10 @@
 if __name__ == "__main__":
 
     pd.set_option('display.max_rows', None)
     pd.set_option('display.max_columns', None)
     pd.set_option('display.width', None)
     pd.set_option('display.max_colwidth', 40)
 
-    # subs = LoadSubcriptions('arn:aws:sns:ca-central-1:078080354147:janitor-pager')
-    subs = LoadSubcriptions('arn:aws:sns:ca-central-1:968734491561:AdminAlert')
-    
+    # subs = LoadSubcriptions('arn:aws:sns:ca-central-1:..... test arn')
+
     print(subs)
```

## o7lib/util/conversion.py

```diff
@@ -11,59 +11,65 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 #************************************************************************
+""" Package for value conversion """
 import math
 
-
+# python -m unittest tests.test_util_conversion
 
 #*************************************************
 #
 #*************************************************
 def SpeedUVToWs(u,v):
+    """ Convert u,v vector to speed """
     return math.sqrt( (u ** 2) + (v ** 2) )
 
 
 
 #*************************************************
 #
 #*************************************************
 def SpeedMsToKnot(ms):
+    """ Convert meter/sec to Knots """
     return ms * 1.944
 
 
 #*************************************************
 #
 #*************************************************
 def DirectionUVToDeg(u,v):
+    """ Convert u,v vector to direction in degree """
     rad = math.atan2(u * -1., v * -1.)
     deg = (rad * 180.) / math.pi
-    if deg < 0 : deg += 360
-    
+    if deg < 0 :
+        deg += 360.0
+
     return deg
 
 
 #*************************************************
 #
 #*************************************************
 def DirectionDegToTxt(deg):
+    """ Convert direction in degree to text """
     txt = [ 'N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSO', 'SO', 'OSO', 'O', 'ONO', 'NO', 'NNO']
     i = round((deg / 360) * 16)
-    if i >= 16: i = 0
+    if i >= 16:
+        i = 0
     return txt[i]
 
 
 
 #*************************************************
 #
 #*************************************************
 if __name__ == "__main__":
 
 
     for d in range(0,360):
         print(f'{d} -> {DirectionDegToTxt(d)}')
 
- 
-   
+
```

## o7lib/util/displays.py

```diff
@@ -16,14 +16,15 @@
 #
 #************************************************************************
 
 """Package for Console Display Util Functions """
 
 import datetime
 import shutil
+import json
 
 
 #---------------------------
 # TO DO
 #---------------------------
 #
 #---------------------------
@@ -92,17 +93,14 @@
 #*************************************************
 def ConsoleTitle(left = "", center = "", right = ""):
     """Clear Console & add Title"""
     ClearDisplay()
     ConsoleTitleLine(left, center, right)
 
 
-
-
-
 #*************************************************
 #
 #*************************************************
 def FormatAWSStatus(val):
     """Return the value with the color depending on AWS Status"""
     ret = val
     val = val.upper()
@@ -197,16 +195,16 @@
     """Convert a DateTime or Seconds (int) into Text about the elapse time (ex: 6 sec, 3.2 min)"""
 
     # print(f'FormatSince Value Type {type(value)} {value=}')
     timeUnits = [
         {'txt': 'sec', 'scale' : 60.0},
         {'txt': 'min', 'scale' : 60.0},
         {'txt': 'hr', 'scale' : 24.0},
-        {'txt': 'day', 'scale' : 24.0},
-        {'txt': 'yr', 'scale' : 365.0},
+        {'txt': 'day', 'scale' : 365.0},
+        {'txt': 'yr', 'scale' : 100.0},
         {'txt': 'ct', 'scale' : 100.0}
     ]
 
     if value is None:
         return ''
 
     since = None
@@ -215,15 +213,18 @@
     if isinstance(value, int):
         since = value
     elif isinstance(value, float):
         since = value
     elif isinstance(value, str):
         since = float(value)
     elif isinstance(value, datetime.datetime):
-        delta = datetime.datetime.utcnow() - value
+        if value.tzinfo is None:
+            delta = datetime.datetime.utcnow() - value
+        else:
+            delta = datetime.datetime.now(datetime.timezone.utc) - value
         since = delta.total_seconds()
     else:
         return 'NA'
 
     since = float(since)
     unit = 'NA'
 
@@ -232,29 +233,60 @@
         unit = timeUnit['txt']
         if since < timeUnit['scale']:
             break
         since = since / timeUnit['scale']
 
     return f'{since:.1f} {unit}'
 
+#*************************************************
+#
+#*************************************************
+def SearchValueInDict(dataName, data):
+    """Search a Dict data structure for a specified name.  key.key format can be used"""
+
+    if data is None or isinstance(data, dict) is False:
+        return None
+
+    value = data.get(dataName, None)
+    if value is not None:
+        return value
+
+    # Try to find value by spliting keys with .
+    for i, key in enumerate(dataName.split(".")):
+        #print(f'-> {i} - {key}')
+        if i == 0:
+            value = data.get(key, None)
+        else:
+            if isinstance(value, str):
+                value = json.loads(value)
+
+            value = value.get(key, None)
+
+        #print(f'{value=}')
+
+        if value is None:
+            return None
+
+    return value
+
 
 #*************************************************
 #
 #*************************************************
 def Table(params, datas):
     """
     Print a Table on Screen from parameters and a data array.
 
     Args:
         params (dict):
             title (string): Table Tile
             columns (list): Each elements defines a column
                 [{
                     type: Data type, options
-                        i = index
+                        i = index in array (1 ... lenght)
                         str = string
                         date = datetime displayed in format YYYY-MM-DD
                         datetime =  datetime displayed in format YYYY-MM-DD HH:MM:SS
                         since =  Duration between value and now (must be a datetime)
                     dataName : Key name in the data list
                     title : Column name to display
 
@@ -272,51 +304,57 @@
 
 
     """
 
     columns = params.get('columns', [])
     tableWidth = 0
     consoleWidth = GetTerminalWidth()
+    formatedDatas = list({} for i in range(len(datas)))
 
     #----------------------------
     # Loop to prepare data
     #----------------------------
     for col in columns :
 
         dataType = col.get('type', 'str')
         if dataType == 'i':
             col['dataName'] = 'i'
 
-        dataName = col.get('dataName', 'not set')
+        dataName = col.get('dataName', 'not-set')
 
         maxW = col.get('maxWidth', None)
         minW = col.get('minWidth', None)
         fixW = col.get('fixWidth', None)
 
         width = len(col.get('title', ''))
 
-        index = 0
-        for data in datas:
-            index += 1
-            value = data.get(dataName, None)
+        for i, data in enumerate(datas):
+
+            # Get and Transform data
+            index = i + 1
 
+            # Get value with support of "." enumeration
+            value = SearchValueInDict(dataName, data)
+
+            # Reformat Value
             if dataType == 'i':
                 value = str(index)
             elif value is None:
                 value = ''
             elif dataType == 'date':
-                value = FormatDatetime(data.get(dataName, None), '%Y-%m-%d')
+                value = FormatDatetime(value, '%Y-%m-%d')
             elif dataType == 'datetime' and value is not None:
-                value = FormatDatetime(data.get(dataName, None), '%Y-%m-%d %H:%M:%S')
+                value = FormatDatetime(value, '%Y-%m-%d %H:%M:%S')
             elif dataType == 'since':
                 value = FormatSince(value)
             else: value = str(value)
 
-            data[dataName] = value
+            value = value.replace('\n', ' ')
 
+            formatedDatas[i][dataName] = value
             width = max(width, len(value))
 
         if maxW is not None:
             width = min(width, maxW)
         if minW is not None:
             width = max(width, minW)
         if fixW is not None:
@@ -349,18 +387,19 @@
     title = params.get('title', None)
     if title is not None:
         title = title.center(tableWidth, ' ')
         print(f"{Colors.HEADER}{title}{Colors.ENDC}")
 
     print(f"{Colors.HEADER}{topRow}{Colors.ENDC}")
 
+
     #----------------------------
     # Loop to print all data Rows
     #----------------------------
-    for data in datas:
+    for data in formatedDatas:
         dataRow = ''
         for col in columns :
             dataName = col.get('dataName', 'not set')
             colWidth = col.get('width')
             colFormat = col.get('format', '')
 
             if colWidth < 1:
```

## Comparing `o7cli-0.1.85.dist-info/LICENSE` & `o7cli-0.1.95.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `o7cli-0.1.85.dist-info/METADATA` & `o7cli-0.1.95.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: o7cli
-Version: 0.1.85
+Version: 0.1.95
 Summary: Useful CLI and scripts for O7 Conseils DevOps practice
 Home-page: UNKNOWN
 Author: Philippe Gosselin
 Author-email: phil@o7conseils.com
 License: LICENSE
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

## Comparing `o7cli-0.1.85.dist-info/RECORD` & `o7cli-0.1.95.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,50 +1,50 @@
 o7lib/__init__.py,sha256=NsG72jrytmN2Oz4gdhTYZbxwWjgRc63IPpQb_Q8EJiU,83
 o7lib/__main__.py,sha256=u2sHeTVrTwL_KC0s8jHvrat8fyfOfJkAeR9cv_7WWFw,1087
 o7lib/menu.py,sha256=49SwVV7BwH-NbWlSYMUp8j6JVZM9zdq5qOJgRkm4wIE,5626
-o7lib/version.py,sha256=dm6LM3XZlVfSStMq58T-Eqkw9bG2cihzqG6f0uvMSug,87
+o7lib/version.py,sha256=jIM9sWB_G5PMO-IsiCo-30Y-5k0aK27_YHJatodIXO8,87
 o7lib/auth/__init__.py,sha256=pIFSlhIetOTzcP6FcHc5RrCIP_68Q8hJ3w7Yqk7N-cw,80
 o7lib/auth/openid.py,sha256=2qqT5rMbqH3H20b6E735XpkFtwbFHH4ktBERvQq_bUM,6817
 o7lib/aws/__init__.py,sha256=k3yXGaMWiSwoOApK0zX056RkJzixPFX1Hwe2WWfLqH0,79
 o7lib/aws/asg.py,sha256=54mCL4JqeO6g7DBO5gHq_LGSXJJqTTA4TrlgqHwhKsY,4806
 o7lib/aws/base.py,sha256=_X0FeCIIwhLo0M1ktQaLrpgWjj4o0nLxBNMhVZfS1D0,2453
-o7lib/aws/cloudformation.py,sha256=XqC7iK4_uWbn_PqLUlfgol54OziNQIT7qjOnSRMAN-o,20931
+o7lib/aws/cloudformation.py,sha256=hQbD34Gowuq5uE_oOpWbBzQnX4_2L-CzxmskaIP43V4,20501
 o7lib/aws/cloudmap.py,sha256=vzUXGTPD5pGx_llX1ZqNMn3ewypPSy7Ryi0jpXHsFSk,9252
 o7lib/aws/cloudtrail.py,sha256=Nl5E2iScwO1b0qtiFSBwNNgNvk0KKNRohws4OzWeDAo,3315
 o7lib/aws/cloudwatch.py,sha256=xoMhMvWG4I1I0__jbutkiBmQV6Fcz7XAhSZCwbTQVAA,5249
-o7lib/aws/codebuild.py,sha256=okDCo_ONyvaw2Hkg5tqtmOCnT6nPfqe-8pw26RJO_MM,16408
+o7lib/aws/codebuild.py,sha256=uDkhRbFl6xdBIzcBjpq6cFKU44T9zJdZ8kD-O7UYpys,16241
 o7lib/aws/costexplorer.py,sha256=5dZFFQ8QtFHkHLBsflAQ_GxY-aGsjZ06Bfpc3bLJoz4,10543
-o7lib/aws/ec2.py,sha256=p-pH-8M7yFsZKLsyw5v90obaYkgvo7I3gdyjsNQJSso,5348
+o7lib/aws/ec2.py,sha256=OVJdy4OhYAN4Nm9QquyXJgvB1WiA8acRxr58Va4PI50,5302
 o7lib/aws/eventbridge.py,sha256=ScdF7jDzIfKM9Bdlm41Bv9SaGogOedv3hJm6Y949HbY,5680
-o7lib/aws/events.py,sha256=Wa9Jq-58KykfSJhg_qNK6vgR_Oaj69NkiiYfbWeT0SY,10793
+o7lib/aws/events.py,sha256=tCCs6wmCu0PPv9wZ0pfS1tO945B00w-LMeiNaJJEvGo,3549
 o7lib/aws/guardduty.py,sha256=ZHcBcpPKnJNAz2HXqE-fROrq4UQfMRvwvvg1pQUgBrg,4545
 o7lib/aws/iam-access-key-mng.py,sha256=iiTgQIUZutphkFYYfnxy9fIZImWU8wvQJGat6SUhCd8,6648
-o7lib/aws/lambdafct.py,sha256=NwPA4WyJUfXo3mbtTTUZPlDXmCLf0SS8JymKoJ6CsFQ,4566
+o7lib/aws/lambdafct.py,sha256=_1RRWvGYxKVA8urdP_UGExhBztS0Fe2l0y6W_G5sLI0,4521
 o7lib/aws/logs.py,sha256=Fp4UTvrdYlHFgJAjFKjh_x_gaz-J7sUscQIZuBtG-IA,7765
-o7lib/aws/logstream.py,sha256=qGSikn_ouvsCZ7HI5tRV0ByOA6BxoFBTvvs06mj14ug,7742
-o7lib/aws/pipeline.py,sha256=KW-Si88IpnDTTPgfMMPpbEZO8hNk45FCrVdQUNFItV8,20609
-o7lib/aws/rds.py,sha256=T2sN752yt3BDg2c9o_HiI-uO5LWhUDhXnM5jBKwpHBw,6236
+o7lib/aws/logstream.py,sha256=awD_a8JSPMBHeCaGI4BpqsM_fV4XBF4aWlS6hBIMdSM,7248
+o7lib/aws/pipeline.py,sha256=DP1upH9OvxK0ljo31eqdHFJ4fN_CkYg4X3juVMyngz8,25883
+o7lib/aws/rds.py,sha256=VfOosFdhVGAAFj002hNyPCYEkOmi5t4akW-LBUY8m24,6141
 o7lib/aws/reports.py,sha256=6nobg7MfjX7pkrWw42fCkLbgdmmcUGC1js-zbynI1U8,2627
-o7lib/aws/sns.py,sha256=xSFD4Jp6zDH2gLX2lk7d6WgZOFjIMI9TjS6vSfDDPfI,2837
+o7lib/aws/sns.py,sha256=9SToIIDh-bNGbR7sB7wd7S0PSocZS4rHMU0yt6Gapf0,2737
 o7lib/aws/sts.py,sha256=Q_gx6NREH-lg2P6ciSyOp8C1IurDIT0IjHhus2d5Yi0,2136
 o7lib/util/__init__.py,sha256=k3yXGaMWiSwoOApK0zX056RkJzixPFX1Hwe2WWfLqH0,79
 o7lib/util/color.py,sha256=2YMosvfpeQMT_rh8A76CxEc-puvLk9BxG04E3KhUOM0,4955
-o7lib/util/conversion.py,sha256=nDZB5N3YOaoAdjmfwbISRra6rACr8kozH2-aGa6Q1xI,1892
-o7lib/util/displays.py,sha256=g3jnWX76FPusEybkKfjkLPidsC7j1wx-qrBvZ03RBBo,12238
+o7lib/util/conversion.py,sha256=yzRLx37Hgyjja9305VPSRz0fiWnO4wy1T4vgn_64Uj0,2167
+o7lib/util/displays.py,sha256=9g3K3GNMOMzxaH1_e6ufJoGmMGAQDwdoAkIgxaxoIPY,13434
 o7lib/util/input.py,sha256=2K8ARBvUjZA2fvnEcL1zQg6VT15J6K6WLAcYo-Y8dns,2638
 o7lib/util/progressbar.py,sha256=a9iicFFQSR38iM8eyiR3sVerO7mv3w1PiybilMqvZzY,698
 o7lib/util/report.py,sha256=-qmsmMG8Q5Dq3RvYPd0whYLSd-DrRXGUx-56fAfW260,10617
 o7lib/util/run.py,sha256=6XD8KARm7GH8-HTCMpBq9Wa-XiAjzqpA8DpNFYcDMTg,2395
 o7lib/weather/__init__.py,sha256=pIFSlhIetOTzcP6FcHc5RrCIP_68Q8hJ3w7Yqk7N-cw,80
 o7lib/weather/__main__.py,sha256=swiKEYU_fCIquMWFUfYD2SvAD50kqYfSA7DozWChJ7s,873
 o7lib/weather/ca_mf.py,sha256=wR430pZXGa8WbKF85wu7rOcG11w9LtoHCQlnaAm-e1U,2399
 o7lib/weather/ca_wls.py,sha256=M_NrOkXc6u0lcZZvPdmf8QIWqtllRLn89K023FikKOQ,6809
 o7lib/weather/noaa.py,sha256=-fzPQJqSvEusFQteBFVtFqwg1gaWXmTrFLoTHnlH2AE,3844
 o7lib/weather/openweather.py,sha256=qMlypFixzdbPlU4n8mtmj4K7Z159hBvI4HqbeyYUiY4,4442
 o7lib/weather/planetos.py,sha256=w4uhD_0dMPaVF05pOa8NgD2USFu74jC-bdwhIv9qKE8,6911
 o7lib/weather/wind_report.py,sha256=avw-cUK9rZQfU-Z28rKcxxmEO_mCXROQMVJ205c4Buo,14315
-o7cli-0.1.85.dist-info/LICENSE,sha256=6_dFLKv7DjBqhFgHedPIJa6Q3i4sSGnEMCKktR1skME,575
-o7cli-0.1.85.dist-info/METADATA,sha256=oRcaiMIzG_x5OlbqiVU5rbPSic2gmag-4xS3DKoV1Lk,1511
-o7cli-0.1.85.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
-o7cli-0.1.85.dist-info/entry_points.txt,sha256=y9Aj6U7kFswEfdf2hGWJy898p8UwGjXTcPZxW0UBmY4,40
-o7cli-0.1.85.dist-info/top_level.txt,sha256=5GBLOZKKuvNnFABwRi_ANb4izDebKwYpRBazPi47vc8,6
-o7cli-0.1.85.dist-info/RECORD,,
+o7cli-0.1.95.dist-info/LICENSE,sha256=6_dFLKv7DjBqhFgHedPIJa6Q3i4sSGnEMCKktR1skME,575
+o7cli-0.1.95.dist-info/METADATA,sha256=Zd7tcH9reXr3UsLH5KoCXR49v_mLGcv6qYRAemKs7Bg,1511
+o7cli-0.1.95.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
+o7cli-0.1.95.dist-info/entry_points.txt,sha256=y9Aj6U7kFswEfdf2hGWJy898p8UwGjXTcPZxW0UBmY4,40
+o7cli-0.1.95.dist-info/top_level.txt,sha256=5GBLOZKKuvNnFABwRi_ANb4izDebKwYpRBazPi47vc8,6
+o7cli-0.1.95.dist-info/RECORD,,
```

